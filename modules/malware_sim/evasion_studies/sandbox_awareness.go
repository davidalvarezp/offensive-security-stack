package evasion_studies

import (
	"github.com/davidalvarezp/offensive-security-stack/internal/core"
	"github.com/davidalvarezp/offensive-security-stack/internal/reporting"
)

type SandboxAwareness struct {
	Reporter *reporting.ReportManager
}

func NewSandboxAwareness(r *reporting.ReportManager) *SandboxAwareness {
	return &SandboxAwareness{Reporter: r}
}

func (m *SandboxAwareness) Name() string {
	return "malware-evasion-sandbox-awareness"
}

func (m *SandboxAwareness) Description() string {
	return "Explains sandbox detection concepts (theoretical)"
}

func (m *SandboxAwareness) Run(ctx *core.AppContext) error {
	report := `
Sandbox Awareness Concepts:
- Environment fingerprinting
- Timing analysis
- Limited user activity
- Defensive takeaway: instrument sandboxes realistically
`
	m.Reporter.AddReport("Sandbox Awareness", m.Name(), report)
	ctx.Logger.Warn("Sandbox awareness concepts discussed (no detection code)")
	return nil
}
