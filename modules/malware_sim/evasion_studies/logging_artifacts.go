package evasion_studies

import (
	"github.com/davidalvarezp/offensive-security-stack/internal/core"
	"github.com/davidalvarezp/offensive-security-stack/internal/reporting"
)

type LoggingArtifacts struct {
	Reporter *reporting.ReportManager
}

func NewLoggingArtifacts(r *reporting.ReportManager) *LoggingArtifacts {
	return &LoggingArtifacts{Reporter: r}
}

func (m *LoggingArtifacts) Name() string {
	return "malware-evasion-logging-artifacts"
}

func (m *LoggingArtifacts) Description() string {
	return "Examines logging artifacts left by malware-like behavior"
}

func (m *LoggingArtifacts) Run(ctx *core.AppContext) error {
	report := `
Logging Artifacts:
- Process creation logs
- Network connection attempts
- File access metadata
- Detection relies on correlation
`
	m.Reporter.AddReport("Logging Artifacts", m.Name(), report)
	ctx.Logger.Info("Malware logging artifacts reviewed")
	return nil
}
