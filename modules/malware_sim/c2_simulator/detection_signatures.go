package c2_simulator

import (
	"github.com/davidalvarezp/offensive-security-stack/internal/core"
	"github.com/davidalvarezp/offensive-security-stack/internal/reporting"
)

type DetectionSignatures struct {
	Reporter *reporting.ReportManager
}

func NewDetectionSignatures(r *reporting.ReportManager) *DetectionSignatures {
	return &DetectionSignatures{Reporter: r}
}

func (m *DetectionSignatures) Name() string {
	return "malware-c2-detection-signatures"
}

func (m *DetectionSignatures) Description() string {
	return "Maps simulated C2 behavior to detection signatures"
}

func (m *DetectionSignatures) Run(ctx *core.AppContext) error {
	report := `
Detection Signatures:
- Regular beacon interval
- Constant packet size
- Repeating destination host
- Easily detectable via network analytics
`
	m.Reporter.AddReport("C2 Detection Signatures", m.Name(), report)
	ctx.Logger.Info("C2 detection signatures analyzed (educational)")
	return nil
}
