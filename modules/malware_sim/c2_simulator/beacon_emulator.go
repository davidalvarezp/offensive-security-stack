package c2_simulator

import (
	"github.com/davidalvarezp/offensive-security-stack/internal/core"
	"github.com/davidalvarezp/offensive-security-stack/internal/reporting"
)

type BeaconEmulator struct {
	Reporter *reporting.ReportManager
}

func NewBeaconEmulator(r *reporting.ReportManager) *BeaconEmulator {
	return &BeaconEmulator{Reporter: r}
}

func (m *BeaconEmulator) Name() string {
	return "malware-c2-beacon-emulator"
}

func (m *BeaconEmulator) Description() string {
	return "Simulates command-and-control beacon timing and structure"
}

func (m *BeaconEmulator) Run(ctx *core.AppContext) error {
	report := `
C2 Beacon Simulation:
- Interval: 60 seconds (fixed)
- Payload size: 256 bytes
- Destination: controller.example (simulated)
- Pattern: periodic outbound check-in
`
	m.Reporter.AddReport("C2 Beacon Emulator", m.Name(), report)
	ctx.Logger.Warn("C2 beacon behavior emulated (no traffic generated)")
	return nil
}
