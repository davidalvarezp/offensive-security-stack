package lifecycle

import (
	"github.com/davidalvarezp/offensive-security-stack/internal/core"
	"github.com/davidalvarezp/offensive-security-stack/internal/reporting"
)

type PersistenceModels struct {
	Reporter *reporting.ReportManager
}

func NewPersistenceModels(r *reporting.ReportManager) *PersistenceModels {
	return &PersistenceModels{Reporter: r}
}

func (m *PersistenceModels) Name() string {
	return "malware-lifecycle-persistence-models"
}

func (m *PersistenceModels) Description() string {
	return "Describes persistence techniques at a conceptual level"
}

func (m *PersistenceModels) Run(ctx *core.AppContext) error {
	report := `
Persistence Models (Conceptual):
- Startup scripts
- Scheduled tasks
- Service registration
- Defensive focus: integrity monitoring
`
	m.Reporter.AddReport("Persistence Models", m.Name(), report)
	ctx.Logger.Warn("Persistence techniques discussed (no persistence created)")
	return nil
}
