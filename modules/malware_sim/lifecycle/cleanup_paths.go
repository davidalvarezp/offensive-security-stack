package lifecycle

import (
	"github.com/davidalvarezp/offensive-security-stack/internal/core"
	"github.com/davidalvarezp/offensive-security-stack/internal/reporting"
)

type CleanupPaths struct {
	Reporter *reporting.ReportManager
}

func NewCleanupPaths(r *reporting.ReportManager) *CleanupPaths {
	return &CleanupPaths{Reporter: r}
}

func (m *CleanupPaths) Name() string {
	return "malware-lifecycle-cleanup-paths"
}

func (m *CleanupPaths) Description() string {
	return "Models malware cleanup and artifact removal stages"
}

func (m *CleanupPaths) Run(ctx *core.AppContext) error {
	report := `
Cleanup Phase:
- Temporary files removed
- Logs tampered (conceptual)
- Processes terminated
- Detection focus: missing logs, gaps
`
	m.Reporter.AddReport("Cleanup Paths", m.Name(), report)
	ctx.Logger.Info("Malware cleanup phase modeled")
	return nil
}
