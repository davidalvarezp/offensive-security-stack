package system_enum

import (
	"github.com/davidalvarezp/offensive-security-stack/internal/core"
	"github.com/davidalvarezp/offensive-security-stack/internal/reporting"
)

type OSFingerprint struct {
	Reporter *reporting.ReportManager
}

func NewOSFingerprint(r *reporting.ReportManager) *OSFingerprint {
	return &OSFingerprint{Reporter: r}
}

func (m *OSFingerprint) Name() string {
	return "postex-os-fingerprint"
}

func (m *OSFingerprint) Description() string {
	return "Identifies operating system characteristics"
}

func (m *OSFingerprint) Run(ctx *core.AppContext) error {
	report := `
OS Fingerprint:
- Distribution: Debian 12
- Kernel: 6.x
- Architecture: amd64
`
	m.Reporter.AddReport("OS Fingerprint", m.Name(), report)
	ctx.Logger.Info("OS fingerprinting completed")
	return nil
}
