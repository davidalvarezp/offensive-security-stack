package system_enum

import (
	"github.com/davidalvarezp/offensive-security-stack/internal/core"
	"github.com/davidalvarezp/offensive-security-stack/internal/reporting"
)

type ProcessInventory struct {
	Reporter *reporting.ReportManager
}

func NewProcessInventory(r *reporting.ReportManager) *ProcessInventory {
	return &ProcessInventory{Reporter: r}
}

func (m *ProcessInventory) Name() string {
	return "postex-process-inventory"
}

func (m *ProcessInventory) Description() string {
	return "Inventories running processes (simulated)"
}

func (m *ProcessInventory) Run(ctx *core.AppContext) error {
	report := `
Process Inventory:
- sshd (root)
- nginx (www-data)
- postgres (postgres)
`
	m.Reporter.AddReport("Process Inventory", m.Name(), report)
	ctx.Logger.Info("Process inventory completed")
	return nil
}
