package system_enum

import (
	"github.com/davidalvarezp/offensive-security-stack/internal/core"
	"github.com/davidalvarezp/offensive-security-stack/internal/reporting"
)

type ServiceMapping struct {
	Reporter *reporting.ReportManager
}

func NewServiceMapping(r *reporting.ReportManager) *ServiceMapping {
	return &ServiceMapping{Reporter: r}
}

func (m *ServiceMapping) Name() string {
	return "postex-service-mapping"
}

func (m *ServiceMapping) Description() string {
	return "Maps services to users, ports, and trust level"
}

func (m *ServiceMapping) Run(ctx *core.AppContext) error {
	report := `
Service Mapping:
- nginx → TCP/80 → www-data
- sshd → TCP/22 → root
- postgres → TCP/5432 → postgres
`
	m.Reporter.AddReport("Service Mapping", m.Name(), report)
	ctx.Logger.Info("Service mapping completed")
	return nil
}
