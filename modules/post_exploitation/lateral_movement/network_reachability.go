package lateral_movement

import (
	"github.com/davidalvarezp/offensive-security-stack/internal/core"
	"github.com/davidalvarezp/offensive-security-stack/internal/reporting"
)

type NetworkReachability struct {
	Reporter *reporting.ReportManager
}

func NewNetworkReachability(r *reporting.ReportManager) *NetworkReachability {
	return &NetworkReachability{Reporter: r}
}

func (m *NetworkReachability) Name() string {
	return "postex-network-reachability"
}

func (m *NetworkReachability) Description() string {
	return "Maps reachable hosts from a compromised node (simulated)"
}

func (m *NetworkReachability) Run(ctx *core.AppContext) error {
	report := `
Network Reachability:
- Host A → Host B (SMB allowed)
- Host A → Host C (SSH allowed)
- Host A → DB Server (blocked)
`
	m.Reporter.AddReport("Network Reachability", m.Name(), report)
	ctx.Logger.Info("Network reachability analysis completed")
	return nil
}
